databaseChangeLog:
- changeSet:
    id: salut-change-30-1
    author: Limit
    changes:
    - addColumn:
        tableName: ${db_prefix}salut
        columns:
        - column:
            name: tipus_registre
            type: VARCHAR(10 ${varcharUnit})
            defaultValue: MINUT
            constraints:
              nullable: false
    - createIndex:
        tableName: ${db_prefix}salut
        indexName: ${db_prefix}salut_tipus_registre_id
        columns:
        - column:
            name: tipus_registre
    - createIndex:
        tableName: ${db_prefix}salut
        indexName: ${db_prefix}salut_entorn_data_id
        columns:
        - column:
            name: entorn_app_id
        - column:
            name: data
- changeSet:
    id: salut-change-30-2
    author: Limit
    changes:
    - addColumn:
        tableName: ${db_prefix}salut
        columns:
        - column:
            name: app_count_up
            type: INTEGER
            defaultValueNumeric: 0
        - column:
            name: app_count_warn
            type: INTEGER
            defaultValueNumeric: 0
        - column:
            name: app_count_degraded
            type: INTEGER
            defaultValueNumeric: 0
        - column:
            name: app_count_down
            type: INTEGER
            defaultValueNumeric: 0
        - column:
            name: app_count_error
            type: INTEGER
            defaultValueNumeric: 0
        - column:
            name: app_count_maintenance
            type: INTEGER
            defaultValueNumeric: 0
        - column:
            name: app_count_unknown
            type: INTEGER
            defaultValueNumeric: 0
        - column:
            name: bd_count_up
            type: INTEGER
            defaultValueNumeric: 0
        - column:
            name: bd_count_warn
            type: INTEGER
            defaultValueNumeric: 0
        - column:
            name: bd_count_degraded
            type: INTEGER
            defaultValueNumeric: 0
        - column:
            name: bd_count_down
            type: INTEGER
            defaultValueNumeric: 0
        - column:
            name: bd_count_error
            type: INTEGER
            defaultValueNumeric: 0
        - column:
            name: bd_count_maintenance
            type: INTEGER
            defaultValueNumeric: 0
        - column:
            name: bd_count_unknown
            type: INTEGER
            defaultValueNumeric: 0
        - column:
            name: app_latencia_mitjana
            type: INTEGER
        - column:
            name: app_latencia_num_elements
            type: INTEGER
        - column:
            name: bd_latencia_mitjana
            type: INTEGER
        - column:
            name: bd_latencia_num_elements
            type: INTEGER
        - column:
            name: data_app
            type: TIMESTAMP
        - column:
            name: num_elements
            type: INTEGER

- changeSet:
    id: salut-change-30-3
    author: Limit
    changes:
    - addColumn:
        tableName: ${db_prefix}salut_integracio
        columns:
        - column:
            name: count_up
            type: INTEGER
            defaultValueNumeric: 0
        - column:
            name: count_warn
            type: INTEGER
            defaultValueNumeric: 0
        - column:
            name: count_degraded
            type: INTEGER
            defaultValueNumeric: 0
        - column:
            name: count_down
            type: INTEGER
            defaultValueNumeric: 0
        - column:
            name: count_error
            type: INTEGER
            defaultValueNumeric: 0
        - column:
            name: count_maintenance
            type: INTEGER
            defaultValueNumeric: 0
        - column:
            name: count_unknown
            type: INTEGER
            defaultValueNumeric: 0
        - column:
            name: estat_num_elements
            type: INTEGER
        - column:
            name: latencia_mitjana
            type: INTEGER
        - column:
            name: latencia_num_elements
            type: INTEGER
- changeSet:
    id: salut-change-30-4
    author: Limit
    changes:
    - addColumn:
        tableName: ${db_prefix}salut_subsistema
        columns:
        - column:
            name: count_up
            type: INTEGER
            defaultValueNumeric: 0
        - column:
            name: count_warn
            type: INTEGER
            defaultValueNumeric: 0
        - column:
            name: count_degraded
            type: INTEGER
            defaultValueNumeric: 0
        - column:
            name: count_down
            type: INTEGER
            defaultValueNumeric: 0
        - column:
            name: count_error
            type: INTEGER
            defaultValueNumeric: 0
        - column:
            name: count_maintenance
            type: INTEGER
            defaultValueNumeric: 0
        - column:
            name: count_unknown
            type: INTEGER
            defaultValueNumeric: 0
        - column:
            name: estat_num_elements
            type: INTEGER
        - column:
            name: latencia_mitjana
            type: INTEGER
        - column:
            name: latencia_num_elements
            type: INTEGER
- changeSet:
    id: salut-change-30-5
    author: Limit
    changes:
    - sql:
        sql: |
          truncate table ${db_prefix}salut_missatge reuse storage;
          truncate table ${db_prefix}salut_detall reuse storage;
          truncate table ${db_prefix}salut_subsistema reuse storage;
          truncate table ${db_prefix}salut_integracio reuse storage;
          truncate table ${db_prefix}salut reuse storage;
