databaseChangeLog:
  - changeSet:
      id: avis-change-67-1
      author: limit
      comment: Creaci√≥ de la taula avis_llegit per a enregistrar si un avis ha estat llegit per un usuari
      changes:
        - createTable:
            tableName: ${db_prefix}avis_llegit
            columns:
              - column:
                  constraints:
                    nullable: false
                    primaryKey: true
                    primaryKeyName: ${db_prefix}avis_llegit_pk
                  name: id
                  type: BIGINT
                  autoIncrement: true
              - column:
                  name: avis_id
                  type: bigint
                  constraints:
                    nullable: false
              - column:
                  name: usuari
                  type: varchar(255)
                  constraints:
                    nullable: false
              - column:
                  constraints:
                    nullable: false
                  name: created_by
                  type: VARCHAR(64 ${varcharUnit})
              - column:
                  constraints:
                    nullable: false
                  name: created_date
                  type: TIMESTAMP
              - column:
                  name: lastmod_by
                  type: VARCHAR(64 ${varcharUnit})
              - column:
                  name: lastmod_date
                  type: TIMESTAMP
              - column:
                  name: v
                  type: BIGINT
        - addForeignKeyConstraint:
            baseTableName: ${db_prefix}avis_llegit
            baseColumnNames: avis_id
            constraintName: com_avis_llegit_avis_fk
            referencedTableName: com_avis
            referencedColumnNames: id
            onDelete: CASCADE
        - addUniqueConstraint:
            tableName: ${db_prefix}avis_llegit
            columnNames: usuari, avis_id
            constraintName: com_avis_llegit_avis_usuari_uk
        - createIndex:
            tableName: ${db_prefix}avis_llegit
            indexName: com_avis_llegit_avis_idx
            columns:
              - column:
                  name: avis_id
              - column:
                  name: usuari
